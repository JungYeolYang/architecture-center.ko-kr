---
title: 신뢰할 수 있는 Azure 애플리케이션 디자인
description: 안정적이고 항상 사용 가능한 Azure 애플리케이션 제작 소개
author: MikeWasson
ms.date: 04/10/2019
ms.topic: article
ms.service: architecture-center
ms.subservice: cloud-design-principles
ms.custom: ''
ms.openlocfilehash: 16c1daeed9b1d79f33051eb69571f1574bf9be4d
ms.sourcegitcommit: 579c39ff4b776704ead17a006bf24cd4cdc65edd
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/17/2019
ms.locfileid: "59644017"
---
# <a name="designing-reliable-azure-applications"></a>신뢰할 수 있는 Azure 애플리케이션 디자인

클라우드에서 신뢰할 수 있는 애플리케이션을 구축하는 것은 기존 애플리케이션 개발과는 다릅니다. 기존에는 강화를 위해 고성능 하드웨어를 구입해야 했지만, 클라우드 환경에서는 강화 대신 규모 확장을 해야 합니다. 목표는 모든 장애를 막는 것이 아니라 단일 장애 구성 요소의 영향을 최소화하는 것입니다.

신뢰할 수 있는 애플리케이션은 다음과 같습니다.

- **복원력**이 있고 오류로부터 정상적으로 복구하며 전체 복구 전에 최소한의 가동 중지 시간과 데이터 손실로 계속 작동합니다.
- **고가용성(HA)** 을 유지하고 심각한 가동 중지 없이 정상 상태에서 설계한 대로 실행됩니다.

이러한 요소가 함께 작동하는 방법과 비용에 영향을 미치는 방식을 이해하는 것은 신뢰할 수 있는 애플리케이션을 구축하는 데 반드시 필요합니다. 허용 가능한 가동 중지 시간, 비즈니스에 대한 잠재적인 비용 및 복구 시 필요한 기능을 결정하는 데 도움이 됩니다.

이 문서에서는 Azure 애플리케이션 설계 프로세스의 각 단계에서 안정성을 구축하는 것에 대한 간략한 개요를 제공합니다. 각 섹션에는 프로세스에서 해당 특정 단계에 안정성을 통합하는 방법을 자세하게 설명한 문서 링크가 포함되어 있습니다. 개별 Azure 서비스에 대한 안정성 고려 사항이 필요한 경우 [특정 Azure 서비스에 대한 복원력 검사 목록](../checklist/resiliency-per-service.md)을 검토합니다.

## <a name="build-for-reliability"></a>신뢰성 구축

이 섹션에서는 신뢰할 수 있는 Azure 애플리케이션을 구축하기 위한 6단계를 설명합니다. 각 단계는 프로세스와 용어를 추가로 정의하는 섹션에 연결됩니다.

1. [**요구 사항 정의.**](#define-requirements) 구분된 워크로드 및 비즈니스 요구 사항에 따라 가용성 및 복구 요구 사항을 개발합니다.
1. [**아키텍처 모범 사례 사용.**](#use-architectural-best-practices) 검증된 사례를 따르고 아키텍처에서 오류 가능성이 있는 지점을 파악하며 애플리케이션이 오류에 반응하는 방식을 결정합니다.
1. [**시뮬레이션 및 강제 장애 조치(failover)로 테스트.**](#test-with-simulations-and-forced-failovers) 결함을 시뮬레이션하고 강제 장애 조치(failover)를 트리거하며 이러한 오류에서 감지 및 복구를 테스트합니다.
1. [**일관된 애플리케이션 배포.**](#deploy-the-application-consistently) 안정적이고 반복 가능한 프로세스를 사용하여 프로덕션에 릴리스합니다.
1. [**애플리케이션 상태 모니터링.**](#monitor-application-health) 오류를 감지하고 잠재적 오류 표시기를 모니터링하며 애플리케이션 상태를 측정합니다.
1. [**오류 및 재해에 대응.**](#respond-to-failures-and-disasters) 오류가 발생하는 경우를 파악하고 수립된 전략에 따라 해결 방법을 결정합니다.

## <a name="define-requirements"></a>요구 사항 정의

비즈니스 요구 사항을 파악하고 이를 해결하기 위한 안정성 계획을 구축합니다. 다음을 고려해 보세요.

- **워크로드 및 사용 파악.** *워크로드*는 비즈니스 논리와 데이터 스토리지 요구 사항 측면에서 다른 작업과 논리적으로 분리되는 고유 기능 또는 작업입니다. 각 워크로드마다 가용성, 확장성, 데이터 일관성 및 재해 복구에 대한 요구 사항이 서로 다릅니다.
- **사용 패턴 계획.** *사용 패턴*도 요구 사항에서 역할을 수행합니다. 중요 및 중요하지 않은 기간 동안 요구 사항의 차이점을 파악합니다. 예를 들어 세금 신고 애플리케이션은 신고 마감 기간 동안 실패해서는 안 됩니다. 가동 시간을 보장하기 위해 한쪽에서 실패한 경우에 여러 지역에 중복을 계획합니다. 반대로 중요하지 않은 기간 동안 비용을 최소화하기 위해 단일 지역에서 애플리케이션을 실행할 수 있습니다.
- **가용성 메트릭&mdash; *MTTR(평균 복구 시간)* 및 *MTBF(평균 고장 간격)를* 설정합니다.** MTTR은 장애 발생 후 구성 요소를 복원하는 데 걸리는 평균 시간입니다. MTBF는 가동 중단 사이에서 구성 요소가 지속될 것으로 예상되는 기간입니다. 이러한 측정값을 사용하여 중복을 추가할 위치 및 고객에 대한 SLA(서비스 수준 계약)를 결정합니다.  
- **복구 메트릭 &mdash; 복구 시간 목표 및 복구 지점 목표(RPO)를 설정합니다.** *RTO*는 인시던트 후 애플리케이션 중단이 허용되는 최대 시간입니다. *RPO*는 재해 발생 시 허용되는 최대 데이터 손실 기간입니다. 이러한 값을 가져오려면 위험 평가를 수행하고 조직에서 비용 및 가동 중지 시간 또는 데이터 손실에 대한 위험을 이해해야 합니다.
    > [!NOTE]
    > 항상 사용 가능한 설정에서 *모든* 중요 구성 요소의 MTTR이 시스템 RTO를 초과하는 경우 시스템 오류로 인해 허용할 수 없는 업무 중단이 발생할 수 있습니다. 즉, 정의된 RTO 내에서 시스템을 복원할 수 없습니다.
- **워크로드 가용성 대상 결정.** 애플리케이션 아키텍처가 비즈니스 요구 사항을 충족시키기 위해 각 워크로드의 대상 SLA를 정의합니다. 애플리케이션 종속성 외에도 가용성 요구 사항을 충족하는 데 필요한 비용 및 복잡성을 설명합니다.
- **SLA(서비스 수준 계약) 이해.** Azure에서 SLA는 작동 시간 및 연결에 대한 Microsoft 정책을 설명합니다. 특정 서비스의 SLA가 99.9%인 경우 시간의 99.9% 동안 서비스를 사용할 수 있습니다.  

    아키텍처가 비즈니스 요구 사항을 충족하는지 파악할 수 있도록 솔루션에서 각 워크로드에 대한 자체 대상 SLA를 정의합니다. 예를 들어 어떤 워크로드가 99.99% 작동 시간을 요구하지만 SLA 99.9% 서비스를 사용하는 경우 해당 서비스는 시스템에서 단일 오류 지점이 될 수 없습니다.

신뢰할 수 있는 애플리케이션의 개발 요구 사항에 대한 자세한 내용은 [복원력 있는 Azure 애플리케이션에 대한 개발 요구 사항](./requirements.md)을 참조하세요.

## <a name="use-architectural-best-practices"></a>아키텍처 모범 사례 사용

아키텍처 단계에서는 비즈니스 요구 사항을 충족하고 오류 지점을 식별하며 실패 범위를 최소화하는 방법 구현에 집중합니다.

- **FMA(실패 모드 분석) 수행.** FMA는 설계 단계 초기에 애플리케이션에 복원력을 구축합니다. 애플리케이션에서 발생할 수 있는 오류 유형, 각각의 잠재적인 영향 및 가능성 있는 복구 전략을 파악하는 데 도움이 됩니다.
- **중복 계획 만들기.** 각 워크로드에 필요한 중복 수준은 애플리케이션의 전반적인 비용에 대한 비즈니스 요구 사항과 요인에 따라 달라집니다. 
- **확장성 설계.** 클라우드 애플리케이션은 사용량 변동을 수용하기 위해 확장할 수 있어야 합니다. 개별 구성 요소를 시작으로 가능할 때면 언제든 부하 변동에 자동으로 응답하는 애플리케이션을 설계합니다. 설계 도중 크기 조정 제한을 고려하면 나중에 쉽게 확장할 수 있습니다.
- **구독 및 서비스 요구 사항 계획.** 스토리지, 연결, 처리량 등에 대한 비즈니스 요구 사항에 맞게 충분한 리소스를 프로비저닝하려면 추가 구독이 필요합니다. 
- **요청을 분산하기 위해 부하 분산 사용.** 부하 분산은 비정상 인스턴스를 윤번에서 제거하여 애플리케이션의 요청을 정상 서비스 인스턴스에 분산합니다.
- **복원력 전략 구현.** *복원력*은 오류를 복구하여 계속 작동하는 시스템 기능입니다. 중요한 리소스 격리, 보정 트랜잭션 사용 및 가능할 때면 언제든 비동기 작업 수행과 같은 [복원력 설계 패턴](../patterns/category/resiliency.md)을 구현합니다.
- **설계 시 가용성 요구 사항 구축.** *가용성*은 시스템이 기능하고 작동하는 시간의 비율입니다. 애플리케이션 가용성이 SLA(서비스 수준 계약)를 준수하는지 확인하는 단계를 수행합니다. 예를 들어 단일 실패 지점을 피하고 서비스 수준 목표로 워크로드를 구분하며 대규모 사용자를 제한합니다.
- **데이터 관리.** 데이터 저장, 백업 및 복제 방법이 중요합니다.

  - **애플리케이션의 데이터에 대한 복제 방법 선택.** 애플리케이션 데이터는 다양한 데이터 저장소에 저장되어 가용성 요구 사항이 서로 다를 수 있습니다. 각 데이터 저장소 유형에 대한 복제 방법 및 위치를 평가하여 요구 사항을 충족하는지 확인합니다.
  - **장애 조치(failover) 및 장애 복구(failback) 프로세스 문서화 및 테스트.** 새 데이터 저장소에 대한 장애 조치(failover) 지침을 정확하게 문서화하고 정기적으로 테스트하여 지침을 정확하고 쉽게 따를 수 있는지 확인합니다.
  - **데이터 보호.** 데이터를 정기적으로 백업하고 유효성 검사를 수행하며 단일 사용자 계정이 프로덕션 및 백업 데이터 모두에 액세스 권한이 없는지 확인합니다.
  - **데이터 복구 계획.** 백업 및 복제 정책이 서비스 수준 요구 사항을 충족하는 데이터 복구 시간을 제공하는지 확인합니다. 참조 데이터 및 데이터베이스를 포함하여 애플리케이션이 사용하는 모든 유형의 데이터를 설명합니다.

신뢰할 수 있는 애플리케이션을 설계하는 방법에 대한 자세한 내용은 [복원력 및 가용성에 대한 Azure 애플리케이션 설계](./architect.md)를 참조하세요.

## <a name="test-with-simulations-and-forced-failovers"></a>시뮬레이션 및 강제 장애 조치(failover)로 테스트

안정성에 대한 테스트에는 간헐적으로 발생하는 오류 조건 하에서 엔드투엔드 워크로드가 수행되는 방식 측정이 필요합니다.

- **실제 오류를 트리거하거나 시뮬레이션하여 일반 오류 시나리오 테스트.** 일반 시나리오(오류 조합 포함) 및 복구 시간을 테스트하는 데 오류 삽입 테스트를 사용합니다.
- **부하에서만 발생하는 오류 파악.** 실제 조건에서 애플리케이션이 어떻게 동작하는지 확인하려면 프로덕션 데이터와 최대한 비슷한 프로덕션 데이터 또는 가상 데이터를 사용하여 최대 부하를 테스트합니다.
- **재해 복구 훈련 실시.** 적절한 재해 복구 계획을 수립하고 제대로 작동하는지 정기적으로 테스트합니다.
- **장애 조치(failover) 및 장애 복구(failback) 테스트 수행.** 애플리케이션의 종속 서비스가 장애 조치(failover) 및 장애 복구(failback)를 올바른 순서로 수행하는지 확인합니다.
- **시뮬레이션 테스트 실행.** 실제 시나리오 테스트가 해결해야 하는 문제를 강조할 수 있습니다. 시나리오는 제어가 가능하고 비즈니스를 방해하지 않아야 합니다. 시뮬레이션 테스트 계획 관리에 대한 정보를 알립니다.
- **상태 프로브 테스트.** 중요한 시스템 구성 요소를 확인하기 위해 부하 분산 장치 및 트래픽 관리자에 대한 상태 프로브를 구성합니다. 적절하게 응답하는지 테스트합니다.
- **모니터링 시스템 테스트.** 오류 발생 가능성을 파악하기 위해 모니터링 시스템이 중요 정보 및 정확한 데이터를 안정적으로 보고하는지 확인합니다.
- **테스트 시나리오에 타사 서비스 포함.** 복구 외에 타사 서비스 중단으로 인해 발생할 수 있는 오류 지점을 테스트합니다.

테스트는 반복적인 프로세스입니다. 애플리케이션을 테스트하고, 결과를 측정하고, 오류를 분석 및 해결하고, 다시 프로세스를 반복합니다.

애플리케이션 안정성 테스트에 대한 자세한 내용은 [복원력 및 가용성에 대한 Azure 애플리케이션 테스트](./testing.md)를 참조하세요.

## <a name="deploy-the-application-consistently"></a>일관된 애플리케이션 배포

*배포*에는 Azure 리소스를 프로비저닝하고, 애플리케이션 코드를 배포하고, 구성 설정을 적용하는 것이 포함됩니다. 업데이트에 세 가지 작업이 모두 관련될 수도 있고 일부만 관련될 수도 있습니다.

애플리케이션이 프로덕션 환경에 배포된 후에는 업데이트로 인해 오류가 발생할 수 있습니다. 예측 가능하고 반복 가능한 배포 프로세스를 사용하여 오류를 최소화합니다.

- **애플리케이션 배포 프로세스 자동화.** 최대한 많은 프로세스를 자동화합니다.
- **가용성을 최대화하도록 릴리스 프로세스 설계.** 릴리스 프로세스가 배포 중에 서비스를 오프라인으로 전환할 것을 요구하는 경우 다시 온라인이 될 때까지 애플리케이션을 사용할 수 없습니다. 플랫폼 준비 및 생산 기능 활용. 파란색/녹색 또는 카나리아 릴리스를 사용하여 업데이트를 배포하면 오류가 발생해도 업데이트를 신속하게 롤백할 수 있습니다.
- **배포에 대한 롤백 계획을 수립합니다.** 마지막으로 성공한 버전으로 복귀해 배포에 실패한 경우 가동 중지 시간을 최소화하도록 롤백 프로세스를 설계합니다.
- **배포 로깅 및 감사.** 단계별 배포 기술을 사용하는 경우 프로덕션에서 실행 중인 애플리케이션의 버전이 둘 이상이 됩니다. 최대한 많은 버전 관련 정보를 캡처하도록 강력한 로깅 전략을 구현합니다.
- **애플리케이션 릴리스 프로세스 문서화.** 릴리스 프로세스를 명확히 정의 및 문서화하고 전체 작업 팀에 사용할 수 있도록 했는지 확인합니다.

애플리케이션 안정성 및 배포에 대한 자세한 내용은 [복원력 및 가용성에 대한 Azure 애플리케이션 배포](./deploy.md)를 참조하세요.

## <a name="monitor-application-health"></a>애플리케이션 상태 모니터링

오류를 감지하고 운영자에게 수정하라고 경고할 수 있도록 애플리케이션에서 모니터링 및 경고에 대한 모범 사례를 구현합니다.

- **상태 프로브 및 확인 기능 구현.** 애플리케이션 상태 및 성능 저하를 파악하기 위해 애플리케이션 외부에서 정기적으로 실행합니다.
- **장기 실행 워크플로 확인.** 사전에 문제를 포착하면 전체 워크플로를 롤백하거나 여러 개의 보정 트랜잭션을 실행하는 필요성을 최소화할 수 있습니다.
- **애플리케이션 로그 유지.**

  - 프로덕션 및 서비스 경계에서 애플리케이션을 로깅합니다.
  - 의미 체계 및 비동기 로깅을 사용합니다.
  - 감사 로그에서 애플리케이션 로그를 분리합니다.

- **원격 호출 통계 측정 및 애플리케이션 팀과 데이터 공유.** 운영 팀이 애플리케이션 상태를 즉시 볼 수 있도록 하려면 99 및 95 백분위수에서 대기 시간, 처리량 및 오류와 같은 원격 호출 메트릭을 요약합니다. 각 백분위 수 내에서 발생하는 오류를 발견하는 메트릭에 대해 통계 분석을 수행합니다.
- **일시적 예외 추적 및 적절한 시간 범위에 재시도.** 시간이 지남에 따라 예외가 증가하는 추세는 서비스에 문제가 있어 서비스가 실패할 수 있다는 것을 나타냅니다.
- **사전 경고 시스템 설정.** 일시적 예외 및 원격 호출 대기 시간 등 애플리케이션 상태의 KPI(주요 성능 지표)를 식별하고 각각의 지표에 대해 적절한 임계값을 설정합니다. 임계값에 도달할 때 작업에 경고를 보냅니다.
- **Azure 구독 제한 내 작업.** Azure 구독에는 리소스 그룹, 코어 및 스토리지 계정 수와 같은 특정 리소스 유형에 대한 제한이 있습니다. 리소스 유형 사용을 확인하세요.
- **타사 서비스를 모니터링합니다.** 고유 식별자를 사용하여 호출을 로깅하고 애플리케이션 상태 및 진단 로깅과의 상관 관계를 지정합니다.
- **애플리케이션을 모니터링하고 수동 복구 단계를 수행하는 여러 연산자 학습.** 하나 이상의 학습된 연산자가 항상 활성 상태인지 확인합니다.

애플리케이션 안정성 모니터링에 대한 자세한 내용은 [Azure 애플리케이션 상태 모니터링](./monitoring.md)을 참조하세요.

## <a name="respond-to-failures-and-disasters"></a>오류 및 재해에 대응

복구 계획을 만들고 데이터 복원, 네트워크 중단, 종속 서비스 오류 및 지역 전체 서비스 중단 해결이 포함되어 있는지 확인합니다. 복구 전략에 VM, 스토리지, 데이터베이스 및 기타 Azure 플랫폼 서비스를 고려합니다.

- **Azure 지원 상호 작용 계획.** 요구가 있기 전에 Azure 지원에 문의하는 프로세스를 설정합니다.
- **재해 복구 계획 문서화 및 테스트.** 애플리케이션 오류에 대한 비즈니스 영향을 반영하는 재해 복구 계획을 작성합니다. 가능한 한 복구 프로세스를 자동화하고 모든 수동 단계를 문서화합니다. 재해 복구 프로세스를 주기적으로 테스트하여 유효성을 검사하고 계획을 개선합니다.
- **필요한 경우 수동으로 장애 조치(failover) 수행.** 일부 시스템은 자동 장애 조치(failover)가 불가능하기 때문에 수동 장애 조치(failover)가 필요합니다. 보조 지역에 대한 애플리케이션 장애 조치(failover)의 경우 운영 준비 테스트를 수행합니다. 장애 복구(failback) 전에 주 지역이 정상 상태이고 다시 트래픽을 받을 준비가 되었는지 확인합니다. 제한된 애플리케이션 기능이 무엇인지 파악하고 앱이 사용자에게 일시적인 문제를 알리는 방법을 결정합니다.
- **애플리케이션 오류 준비.** 처리된 오류, 기능 제한을 유발한 오류, 애플리케이션을 사용할 수 없게 만든 오류를 포함하여 오류 범위를 준비합니다. 애플리케이션은 사용자에게 일시적인 문제가 발생했음을 알려야 합니다.
- **데이터 손상으로부터 복구.** 데이터 저장소에 오류가 발생한 후 데이터를 다시 사용할 수 있게 되었을 때, 특히 데이터가 복제된 경우 데이터 불일치가 있는지 확인합니다. 백업에서 손상된 데이터를 복원합니다.
- **네트워크 가동 중단으로부터 복구.** 캐시된 데이터를 사용하여 제한된 애플리케이션 기능으로 로컬에서 실행할 수 있습니다. 그렇지 않은 경우 애플리케이션 가동 중단을 고려하거나 다른 지역으로 장애 조치(failover)합니다. 연결이 복원될 때까지 대체 위치에 데이터를 저장합니다.
- **종속 서비스 오류로부터 복구.** 계속 사용할 수 있는 기능과 애플리케이션이 응답해야 하는 방법을 결정합니다.
- **지역 전체의 서비스 중단으로부터 복구.** 지역 전체의 서비스 중단은 일반적이지 않지만 특히 중요한 애플리케이션의 경우 이를 해결할 전략이 있어야 합니다. 다른 지역에 애플리케이션을 재배포하거나 트래픽을 재배포할 수 있습니다.

오류 및 재해 복구에 대응하는 방법에 대한 자세한 내용은 [Azure 애플리케이션에 대한 오류 및 재해 복구](./disaster-recovery.md)를 참조하세요.

## <a name="next-steps"></a>다음 단계

> [!div class="nextstepaction"]
> [복원력 있는 애플리케이션에 대한 개발 요구 사항](./requirements.md)
